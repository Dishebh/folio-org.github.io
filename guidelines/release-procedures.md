---
layout: page
title: Release procedures
permalink: /guidelines/release-procedures/
menuInclude: no
menuTopTitle: Guidelines
---

This document summarises the release procedures for FOLIO projects.

## Quick summary
 * `git checkout -b "release-X.Y.Z"`
 * `vi NEWS.md`
 * `git commit -m "Update NEWS" NEWS.md`
 * `mvn -DautoVersionSubmodules=true release:clean release:prepare`
 * `git push && git push --tags`
 * [jenkins](https://jenkins-aws.indexdata.com/job/folio-org/) Log in!
 * [GitHub](https://github.com/folio-org): Merge release branch to master. Release notes!
 * [Jira](https://issues.folio.org): Mark as released. Add next versions.
 * [Slack](https://folio-project.slack.com/) Announce on `#general`

## Introduction

There are separate notes about the
[FOLIO version-numbering scheme](/guidelines/contributing/#version-numbers)
and the [Build, test, and deployment infrastructure](/guides/automation/).

## Maven-based modules

The procedure is outlined here for "Okapi" and is similar for other back-end Maven-based modules.

### Once: Ensure POM declarations

(You only need to do this once for a project. On subsequent releases you can skip this point.)

For Maven-based projects, the [Maven Release Plugin](//maven.apache.org/maven-release/maven-release-plugin)
is required.  To enable the release plugin, add the following to
the parent POM of the project:

```xml
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-release-plugin</artifactId>
  <version>2.5.3</version>
  <configuration>
    <preparationGoals>clean verify</preparationGoals>
    <tagNameFormat>v@{project.version}</tagNameFormat>
    <pushChanges>false</pushChanges>
    <localCheckout>true</localCheckout>
  </configuration>
</plugin>
```
FOLIO projects which need to deploy artifacts to the FOLIO Maven repository during the
Maven 'deploy' phase will have the following specified in the project's top-level POM:

```xml
  <distributionManagement>
    <repository>
      <id>folio-nexus</id>
      <name>FOLIO Release Repository</name>
      <url>https://repository.folio.org/repository/maven-releases/</url>
      <uniqueVersion>false</uniqueVersion>
      <layout>default</layout>
    </repository>
    <snapshotRepository>
      <id>folio-nexus</id>
      <name>FOLIO Snapshot Repository</name>
      <uniqueVersion>true</uniqueVersion>
      <url>https://repository.folio.org/repository/maven-snapshots/</url>
      <layout>default</layout>
    </snapshotRepository>
  </distributionManagement>

  <scm>
    <url>https://github.com/folio-org/PROJECT_NAME</url>
    <connection>scm:git:git://github.com/folio-org/PROJECT_NAME.git</connection>
    <developerConnection>scm:git:git@github.com:folio-org/PROJECT_NAME.git</developerConnection>
    <tag>HEAD</tag>
  </scm>
```

Replace 'PROJECT_NAME' above with the name of the appropriate GitHub repository.
Commit all changes to the POM file.


### Ensure that Jira issues are ready

For the issues that are associated with this release, ensure that they reflect reality,
have the relevant `Fix Version` parameter, and are closed.

### Make a release branch
If you do not have commit access to the master branch (and even if you do), you
can make the release on a branch.
```
git checkout -b "release-X.Y.Z"
```

### Prepare the news document

Edit `NEWS.md` to add concise descriptions and issue numbers for each major item.
Take extra care with spelling and readability.

```
git commit -m "Update NEWS" NEWS.md
```

### Optional: Update any scripts and descriptors for release version

Update version numbers in places that maven will not do automatically, to be the
version you are about to release. That could be ModuleDescriptors, LaunchDescriptors,
or scripts you use for testing and development.

Often it is not necessary to have any such. You should be using the autogenerated
descriptors from templates. Note that scripts can enable the module without mentioning any
version numbers.

```
git commit -a -m "Towards version X.Y.Z"
```

### Prepare and perform the source release

```
mvn -DautoVersionSubmodules=true release:clean release:prepare
```
This command will prompt you for input including the release tag/version,
the next post-release SNAPSHOT version, as well as ask you to resolve
any SNAPSHOT dependencies if you have any. Do NOT create releases with
SNAPSHOT dependencies! Selecting the defaults are typically fine.
Your release tag must be prefixed with 'v' (the default) and you can
always change the next SNAPSHOT version later if necessary.

Assuming there are no build errors, then you are ready to push your changes to
GitHub.

```
git push && git push --tags
```

### Optional: Update any scripts and descriptors for next development release

Update version numbers in the same places you did earlier, but now for the
next development version:

```
git commit -a -m "Towards version X.Y.Q-SNAPSHOT"
git push
```
(If the push fails, you should have been on a release branch. It is not too late
to switch now! `git checkout -b "release-X.Y.Z"`)

### Build and release artifacts

An 'artifact' in this context could either be a Maven artifact released to the FOLIO
Maven repository, a docker image released to Docker Hub, a Linux distribution package
or some combination of artifacts depending on the project.

After preparing the release as explained above, the next step is done via the [FOLIO Jenkins system](https://jenkins-aws.indexdata.com).
Jenkins credentials utilize the Github authentication for FOLIO core developers, so ensure that you are logged in to GitHub to then enable login to Jenkins.

For all modules except Okapi and RMB, select the [Github folio-org](https://jenkins-aws.indexdata.com/job/folio-org/) folder, then follow to the relevant job (e.g.
[mod-circulation](https://jenkins-aws.indexdata.com/job/folio-org/job/mod-circulation/)) and select the "Tags" tab. Select the new release version tag, then the "Build Now" link in the left-hand panel to trigger it.

For Okapi and RMB, select the [Release Jobs](https://jenkins-aws.indexdata.com/job/Release_Jobs/) folder, then follow to the relevant job (e.g.
[okapi-release](https://jenkins-aws.indexdata.com/job/Release_Jobs/job/okapi-release/)).
Select the "Build with Parameters" link in the left-hand panel, then choose the new release tag from the list, and then "Build" to trigger it.

### Merge the release branch into master
Go to GitHub and make a pull request for the release branch you just pushed.
Wait for all the tests to pass and merge the pull request.

### Add release notes to GitHub

Go to the "Releases" area (e.g.
[Okapi](https://github.com/folio-org/okapi/releases)).
Select `Draft a new release` then choose the tag of the new release and add the NEWS portion
-- *only* the part of NEWS since the previous release.

### Prepare Jira for next release

Use the Jira "Admin" interface of your project to "Manage Versions". Mark the current version as
released, and add the next version(s).

### Announce

Send a note to #general on Slack if relevant.

### Improve this doc

If you found some parts of this guide to be out-of-date, or hard to understand,
now is a good time to fix that. Check out the repository [folio-org/folio-org.github.io](https://github.com/folio-org/folio-org.github.io)
and edit `guidelines/release-procedures.md`

## Stripes-based modules

All Stripes modules (i.e. stripes-* and ui-*) follow the
[Stripes release procedure](https://github.com/folio-org/stripes-core/blob/master/doc/release-procedure.md).

